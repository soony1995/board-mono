{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst path = require(\"path\");\nconst ParserHelpers = require(\"./ParserHelpers\");\nclass CommonJsStuffPlugin {\n  apply(compiler) {\n    compiler.hooks.compilation.tap(\"CommonJsStuffPlugin\", (compilation, {\n      normalModuleFactory\n    }) => {\n      const handler = (parser, parserOptions) => {\n        parser.hooks.expression.for(\"require.main.require\").tap(\"CommonJsStuffPlugin\", ParserHelpers.expressionIsUnsupported(parser, \"require.main.require is not supported by webpack.\"));\n        parser.hooks.expression.for(\"module.parent.require\").tap(\"CommonJsStuffPlugin\", ParserHelpers.expressionIsUnsupported(parser, \"module.parent.require is not supported by webpack.\"));\n        parser.hooks.expression.for(\"require.main\").tap(\"CommonJsStuffPlugin\", ParserHelpers.toConstantDependencyWithWebpackRequire(parser, \"__webpack_require__.c[__webpack_require__.s]\"));\n        parser.hooks.expression.for(\"module.loaded\").tap(\"CommonJsStuffPlugin\", expr => {\n          parser.state.module.buildMeta.moduleConcatenationBailout = \"module.loaded\";\n          return ParserHelpers.toConstantDependency(parser, \"module.l\")(expr);\n        });\n        parser.hooks.expression.for(\"module.id\").tap(\"CommonJsStuffPlugin\", expr => {\n          parser.state.module.buildMeta.moduleConcatenationBailout = \"module.id\";\n          return ParserHelpers.toConstantDependency(parser, \"module.i\")(expr);\n        });\n        parser.hooks.expression.for(\"module.exports\").tap(\"CommonJsStuffPlugin\", () => {\n          const module = parser.state.module;\n          const isHarmony = module.buildMeta && module.buildMeta.exportsType;\n          if (!isHarmony) return true;\n        });\n        parser.hooks.evaluateIdentifier.for(\"module.hot\").tap(\"CommonJsStuffPlugin\", ParserHelpers.evaluateToIdentifier(\"module.hot\", false));\n        parser.hooks.expression.for(\"module\").tap(\"CommonJsStuffPlugin\", () => {\n          const module = parser.state.module;\n          const isHarmony = module.buildMeta && module.buildMeta.exportsType;\n          let moduleJsPath = path.join(__dirname, \"..\", \"buildin\", isHarmony ? \"harmony-module.js\" : \"module.js\");\n          if (module.context) {\n            moduleJsPath = path.relative(parser.state.module.context, moduleJsPath);\n            if (!/^[A-Z]:/i.test(moduleJsPath)) {\n              moduleJsPath = `./${moduleJsPath.replace(/\\\\/g, \"/\")}`;\n            }\n          }\n          return ParserHelpers.addParsedVariableToModule(parser, \"module\", `require(${JSON.stringify(moduleJsPath)})(module)`);\n        });\n      };\n      normalModuleFactory.hooks.parser.for(\"javascript/auto\").tap(\"CommonJsStuffPlugin\", handler);\n      normalModuleFactory.hooks.parser.for(\"javascript/dynamic\").tap(\"CommonJsStuffPlugin\", handler);\n    });\n  }\n}\nmodule.exports = CommonJsStuffPlugin;","map":{"version":3,"names":["path","require","ParserHelpers","CommonJsStuffPlugin","apply","compiler","hooks","compilation","tap","normalModuleFactory","handler","parser","parserOptions","expression","for","expressionIsUnsupported","toConstantDependencyWithWebpackRequire","expr","state","module","buildMeta","moduleConcatenationBailout","toConstantDependency","isHarmony","exportsType","evaluateIdentifier","evaluateToIdentifier","moduleJsPath","join","__dirname","context","relative","test","replace","addParsedVariableToModule","JSON","stringify","exports"],"sources":["/home/soon/bulletin-board/node_modules/webpack/lib/CommonJsStuffPlugin.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst path = require(\"path\");\nconst ParserHelpers = require(\"./ParserHelpers\");\n\nclass CommonJsStuffPlugin {\n\tapply(compiler) {\n\t\tcompiler.hooks.compilation.tap(\n\t\t\t\"CommonJsStuffPlugin\",\n\t\t\t(compilation, { normalModuleFactory }) => {\n\t\t\t\tconst handler = (parser, parserOptions) => {\n\t\t\t\t\tparser.hooks.expression\n\t\t\t\t\t\t.for(\"require.main.require\")\n\t\t\t\t\t\t.tap(\n\t\t\t\t\t\t\t\"CommonJsStuffPlugin\",\n\t\t\t\t\t\t\tParserHelpers.expressionIsUnsupported(\n\t\t\t\t\t\t\t\tparser,\n\t\t\t\t\t\t\t\t\"require.main.require is not supported by webpack.\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\tparser.hooks.expression\n\t\t\t\t\t\t.for(\"module.parent.require\")\n\t\t\t\t\t\t.tap(\n\t\t\t\t\t\t\t\"CommonJsStuffPlugin\",\n\t\t\t\t\t\t\tParserHelpers.expressionIsUnsupported(\n\t\t\t\t\t\t\t\tparser,\n\t\t\t\t\t\t\t\t\"module.parent.require is not supported by webpack.\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\tparser.hooks.expression\n\t\t\t\t\t\t.for(\"require.main\")\n\t\t\t\t\t\t.tap(\n\t\t\t\t\t\t\t\"CommonJsStuffPlugin\",\n\t\t\t\t\t\t\tParserHelpers.toConstantDependencyWithWebpackRequire(\n\t\t\t\t\t\t\t\tparser,\n\t\t\t\t\t\t\t\t\"__webpack_require__.c[__webpack_require__.s]\"\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\tparser.hooks.expression\n\t\t\t\t\t\t.for(\"module.loaded\")\n\t\t\t\t\t\t.tap(\"CommonJsStuffPlugin\", expr => {\n\t\t\t\t\t\t\tparser.state.module.buildMeta.moduleConcatenationBailout =\n\t\t\t\t\t\t\t\t\"module.loaded\";\n\t\t\t\t\t\t\treturn ParserHelpers.toConstantDependency(\n\t\t\t\t\t\t\t\tparser,\n\t\t\t\t\t\t\t\t\"module.l\"\n\t\t\t\t\t\t\t)(expr);\n\t\t\t\t\t\t});\n\t\t\t\t\tparser.hooks.expression\n\t\t\t\t\t\t.for(\"module.id\")\n\t\t\t\t\t\t.tap(\"CommonJsStuffPlugin\", expr => {\n\t\t\t\t\t\t\tparser.state.module.buildMeta.moduleConcatenationBailout =\n\t\t\t\t\t\t\t\t\"module.id\";\n\t\t\t\t\t\t\treturn ParserHelpers.toConstantDependency(\n\t\t\t\t\t\t\t\tparser,\n\t\t\t\t\t\t\t\t\"module.i\"\n\t\t\t\t\t\t\t)(expr);\n\t\t\t\t\t\t});\n\t\t\t\t\tparser.hooks.expression\n\t\t\t\t\t\t.for(\"module.exports\")\n\t\t\t\t\t\t.tap(\"CommonJsStuffPlugin\", () => {\n\t\t\t\t\t\t\tconst module = parser.state.module;\n\t\t\t\t\t\t\tconst isHarmony =\n\t\t\t\t\t\t\t\tmodule.buildMeta && module.buildMeta.exportsType;\n\t\t\t\t\t\t\tif (!isHarmony) return true;\n\t\t\t\t\t\t});\n\t\t\t\t\tparser.hooks.evaluateIdentifier\n\t\t\t\t\t\t.for(\"module.hot\")\n\t\t\t\t\t\t.tap(\n\t\t\t\t\t\t\t\"CommonJsStuffPlugin\",\n\t\t\t\t\t\t\tParserHelpers.evaluateToIdentifier(\"module.hot\", false)\n\t\t\t\t\t\t);\n\t\t\t\t\tparser.hooks.expression\n\t\t\t\t\t\t.for(\"module\")\n\t\t\t\t\t\t.tap(\"CommonJsStuffPlugin\", () => {\n\t\t\t\t\t\t\tconst module = parser.state.module;\n\t\t\t\t\t\t\tconst isHarmony =\n\t\t\t\t\t\t\t\tmodule.buildMeta && module.buildMeta.exportsType;\n\t\t\t\t\t\t\tlet moduleJsPath = path.join(\n\t\t\t\t\t\t\t\t__dirname,\n\t\t\t\t\t\t\t\t\"..\",\n\t\t\t\t\t\t\t\t\"buildin\",\n\t\t\t\t\t\t\t\tisHarmony ? \"harmony-module.js\" : \"module.js\"\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (module.context) {\n\t\t\t\t\t\t\t\tmoduleJsPath = path.relative(\n\t\t\t\t\t\t\t\t\tparser.state.module.context,\n\t\t\t\t\t\t\t\t\tmoduleJsPath\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (!/^[A-Z]:/i.test(moduleJsPath)) {\n\t\t\t\t\t\t\t\t\tmoduleJsPath = `./${moduleJsPath.replace(/\\\\/g, \"/\")}`;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn ParserHelpers.addParsedVariableToModule(\n\t\t\t\t\t\t\t\tparser,\n\t\t\t\t\t\t\t\t\"module\",\n\t\t\t\t\t\t\t\t`require(${JSON.stringify(moduleJsPath)})(module)`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(\"javascript/auto\")\n\t\t\t\t\t.tap(\"CommonJsStuffPlugin\", handler);\n\t\t\t\tnormalModuleFactory.hooks.parser\n\t\t\t\t\t.for(\"javascript/dynamic\")\n\t\t\t\t\t.tap(\"CommonJsStuffPlugin\", handler);\n\t\t\t}\n\t\t);\n\t}\n}\nmodule.exports = CommonJsStuffPlugin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}