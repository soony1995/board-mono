{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst LoaderDependency = require(\"./LoaderDependency\");\nconst NormalModule = require(\"../NormalModule\");\n\n/** @typedef {import(\"../Module\")} Module */\n\n/**\n * @callback LoadModuleCallback\n * @param {Error=} err error object\n * @param {string=} source source code\n * @param {object=} map source map\n * @param {Module=} module loaded module if successful\n */\n\nclass LoaderPlugin {\n  apply(compiler) {\n    compiler.hooks.compilation.tap(\"LoaderPlugin\", (compilation, {\n      normalModuleFactory\n    }) => {\n      compilation.dependencyFactories.set(LoaderDependency, normalModuleFactory);\n    });\n    compiler.hooks.compilation.tap(\"LoaderPlugin\", compilation => {\n      compilation.hooks.normalModuleLoader.tap(\"LoaderPlugin\", (loaderContext, module) => {\n        /**\n         * @param {string} request the request string to load the module from\n         * @param {LoadModuleCallback} callback callback returning the loaded module or error\n         * @returns {void}\n         */\n        loaderContext.loadModule = (request, callback) => {\n          const dep = new LoaderDependency(request);\n          dep.loc = {\n            name: request\n          };\n          const factory = compilation.dependencyFactories.get(dep.constructor);\n          if (factory === undefined) {\n            return callback(new Error(`No module factory available for dependency type: ${dep.constructor.name}`));\n          }\n          compilation.semaphore.release();\n          compilation.addModuleDependencies(module, [{\n            factory,\n            dependencies: [dep]\n          }], true, \"lm\", true, err => {\n            compilation.semaphore.acquire(() => {\n              if (err) {\n                return callback(err);\n              }\n              if (!dep.module) {\n                return callback(new Error(\"Cannot load the module\"));\n              }\n              // TODO consider removing this in webpack 5\n              if (dep.module instanceof NormalModule && dep.module.error) {\n                return callback(dep.module.error);\n              }\n              if (!dep.module._source) {\n                throw new Error(\"The module created for a LoaderDependency must have a property _source\");\n              }\n              let source, map;\n              const moduleSource = dep.module._source;\n              if (moduleSource.sourceAndMap) {\n                const sourceAndMap = moduleSource.sourceAndMap();\n                map = sourceAndMap.map;\n                source = sourceAndMap.source;\n              } else {\n                map = moduleSource.map();\n                source = moduleSource.source();\n              }\n              if (dep.module.buildInfo.fileDependencies) {\n                for (const d of dep.module.buildInfo.fileDependencies) {\n                  loaderContext.addDependency(d);\n                }\n              }\n              if (dep.module.buildInfo.contextDependencies) {\n                for (const d of dep.module.buildInfo.contextDependencies) {\n                  loaderContext.addContextDependency(d);\n                }\n              }\n              return callback(null, source, map, dep.module);\n            });\n          });\n        };\n      });\n    });\n  }\n}\nmodule.exports = LoaderPlugin;","map":{"version":3,"names":["LoaderDependency","require","NormalModule","LoaderPlugin","apply","compiler","hooks","compilation","tap","normalModuleFactory","dependencyFactories","set","normalModuleLoader","loaderContext","module","loadModule","request","callback","dep","loc","name","factory","get","constructor","undefined","Error","semaphore","release","addModuleDependencies","dependencies","err","acquire","error","_source","source","map","moduleSource","sourceAndMap","buildInfo","fileDependencies","d","addDependency","contextDependencies","addContextDependency","exports"],"sources":["/home/soon/bulletin-board/node_modules/webpack/lib/dependencies/LoaderPlugin.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst LoaderDependency = require(\"./LoaderDependency\");\nconst NormalModule = require(\"../NormalModule\");\n\n/** @typedef {import(\"../Module\")} Module */\n\n/**\n * @callback LoadModuleCallback\n * @param {Error=} err error object\n * @param {string=} source source code\n * @param {object=} map source map\n * @param {Module=} module loaded module if successful\n */\n\nclass LoaderPlugin {\n\tapply(compiler) {\n\t\tcompiler.hooks.compilation.tap(\n\t\t\t\"LoaderPlugin\",\n\t\t\t(compilation, { normalModuleFactory }) => {\n\t\t\t\tcompilation.dependencyFactories.set(\n\t\t\t\t\tLoaderDependency,\n\t\t\t\t\tnormalModuleFactory\n\t\t\t\t);\n\t\t\t}\n\t\t);\n\n\t\tcompiler.hooks.compilation.tap(\"LoaderPlugin\", compilation => {\n\t\t\tcompilation.hooks.normalModuleLoader.tap(\n\t\t\t\t\"LoaderPlugin\",\n\t\t\t\t(loaderContext, module) => {\n\t\t\t\t\t/**\n\t\t\t\t\t * @param {string} request the request string to load the module from\n\t\t\t\t\t * @param {LoadModuleCallback} callback callback returning the loaded module or error\n\t\t\t\t\t * @returns {void}\n\t\t\t\t\t */\n\t\t\t\t\tloaderContext.loadModule = (request, callback) => {\n\t\t\t\t\t\tconst dep = new LoaderDependency(request);\n\t\t\t\t\t\tdep.loc = {\n\t\t\t\t\t\t\tname: request\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst factory = compilation.dependencyFactories.get(\n\t\t\t\t\t\t\tdep.constructor\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (factory === undefined) {\n\t\t\t\t\t\t\treturn callback(\n\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t`No module factory available for dependency type: ${dep.constructor.name}`\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcompilation.semaphore.release();\n\t\t\t\t\t\tcompilation.addModuleDependencies(\n\t\t\t\t\t\t\tmodule,\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfactory,\n\t\t\t\t\t\t\t\t\tdependencies: [dep]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\"lm\",\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\terr => {\n\t\t\t\t\t\t\t\tcompilation.semaphore.acquire(() => {\n\t\t\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\t\t\treturn callback(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!dep.module) {\n\t\t\t\t\t\t\t\t\t\treturn callback(new Error(\"Cannot load the module\"));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// TODO consider removing this in webpack 5\n\t\t\t\t\t\t\t\t\tif (dep.module instanceof NormalModule && dep.module.error) {\n\t\t\t\t\t\t\t\t\t\treturn callback(dep.module.error);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!dep.module._source) {\n\t\t\t\t\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t\t\t\t\t\"The module created for a LoaderDependency must have a property _source\"\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tlet source, map;\n\t\t\t\t\t\t\t\t\tconst moduleSource = dep.module._source;\n\t\t\t\t\t\t\t\t\tif (moduleSource.sourceAndMap) {\n\t\t\t\t\t\t\t\t\t\tconst sourceAndMap = moduleSource.sourceAndMap();\n\t\t\t\t\t\t\t\t\t\tmap = sourceAndMap.map;\n\t\t\t\t\t\t\t\t\t\tsource = sourceAndMap.source;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tmap = moduleSource.map();\n\t\t\t\t\t\t\t\t\t\tsource = moduleSource.source();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (dep.module.buildInfo.fileDependencies) {\n\t\t\t\t\t\t\t\t\t\tfor (const d of dep.module.buildInfo.fileDependencies) {\n\t\t\t\t\t\t\t\t\t\t\tloaderContext.addDependency(d);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (dep.module.buildInfo.contextDependencies) {\n\t\t\t\t\t\t\t\t\t\tfor (const d of dep.module.buildInfo.contextDependencies) {\n\t\t\t\t\t\t\t\t\t\t\tloaderContext.addContextDependency(d);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn callback(null, source, map, dep.module);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n}\nmodule.exports = LoaderPlugin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}