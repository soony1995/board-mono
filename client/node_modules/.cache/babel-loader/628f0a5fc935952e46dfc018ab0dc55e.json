{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst ExternalModule = require(\"./ExternalModule\");\nclass ExternalModuleFactoryPlugin {\n  constructor(type, externals) {\n    this.type = type;\n    this.externals = externals;\n  }\n  apply(normalModuleFactory) {\n    const globalType = this.type;\n    normalModuleFactory.hooks.factory.tap(\"ExternalModuleFactoryPlugin\", factory => (data, callback) => {\n      const context = data.context;\n      const dependency = data.dependencies[0];\n      const handleExternal = (value, type, callback) => {\n        if (typeof type === \"function\") {\n          callback = type;\n          type = undefined;\n        }\n        if (value === false) return factory(data, callback);\n        if (value === true) value = dependency.request;\n        if (type === undefined && /^[a-z0-9]+ /.test(value)) {\n          const idx = value.indexOf(\" \");\n          type = value.substr(0, idx);\n          value = value.substr(idx + 1);\n        }\n        callback(null, new ExternalModule(value, type || globalType, dependency.request));\n        return true;\n      };\n      const handleExternals = (externals, callback) => {\n        if (typeof externals === \"string\") {\n          if (externals === dependency.request) {\n            return handleExternal(dependency.request, callback);\n          }\n        } else if (Array.isArray(externals)) {\n          let i = 0;\n          const next = () => {\n            let asyncFlag;\n            const handleExternalsAndCallback = (err, module) => {\n              if (err) return callback(err);\n              if (!module) {\n                if (asyncFlag) {\n                  asyncFlag = false;\n                  return;\n                }\n                return next();\n              }\n              callback(null, module);\n            };\n            do {\n              asyncFlag = true;\n              if (i >= externals.length) return callback();\n              handleExternals(externals[i++], handleExternalsAndCallback);\n            } while (!asyncFlag);\n            asyncFlag = false;\n          };\n          next();\n          return;\n        } else if (externals instanceof RegExp) {\n          if (externals.test(dependency.request)) {\n            return handleExternal(dependency.request, callback);\n          }\n        } else if (typeof externals === \"function\") {\n          externals.call(null, context, dependency.request, (err, value, type) => {\n            if (err) return callback(err);\n            if (value !== undefined) {\n              handleExternal(value, type, callback);\n            } else {\n              callback();\n            }\n          });\n          return;\n        } else if (typeof externals === \"object\" && Object.prototype.hasOwnProperty.call(externals, dependency.request)) {\n          return handleExternal(externals[dependency.request], callback);\n        }\n        callback();\n      };\n      handleExternals(this.externals, (err, module) => {\n        if (err) return callback(err);\n        if (!module) return handleExternal(false, callback);\n        return callback(null, module);\n      });\n    });\n  }\n}\nmodule.exports = ExternalModuleFactoryPlugin;","map":{"version":3,"names":["ExternalModule","require","ExternalModuleFactoryPlugin","constructor","type","externals","apply","normalModuleFactory","globalType","hooks","factory","tap","data","callback","context","dependency","dependencies","handleExternal","value","undefined","request","test","idx","indexOf","substr","handleExternals","Array","isArray","i","next","asyncFlag","handleExternalsAndCallback","err","module","length","RegExp","call","Object","prototype","hasOwnProperty","exports"],"sources":["/home/soon/bulletin-board/node_modules/webpack/lib/ExternalModuleFactoryPlugin.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nconst ExternalModule = require(\"./ExternalModule\");\n\nclass ExternalModuleFactoryPlugin {\n\tconstructor(type, externals) {\n\t\tthis.type = type;\n\t\tthis.externals = externals;\n\t}\n\n\tapply(normalModuleFactory) {\n\t\tconst globalType = this.type;\n\t\tnormalModuleFactory.hooks.factory.tap(\n\t\t\t\"ExternalModuleFactoryPlugin\",\n\t\t\tfactory => (data, callback) => {\n\t\t\t\tconst context = data.context;\n\t\t\t\tconst dependency = data.dependencies[0];\n\n\t\t\t\tconst handleExternal = (value, type, callback) => {\n\t\t\t\t\tif (typeof type === \"function\") {\n\t\t\t\t\t\tcallback = type;\n\t\t\t\t\t\ttype = undefined;\n\t\t\t\t\t}\n\t\t\t\t\tif (value === false) return factory(data, callback);\n\t\t\t\t\tif (value === true) value = dependency.request;\n\t\t\t\t\tif (type === undefined && /^[a-z0-9]+ /.test(value)) {\n\t\t\t\t\t\tconst idx = value.indexOf(\" \");\n\t\t\t\t\t\ttype = value.substr(0, idx);\n\t\t\t\t\t\tvalue = value.substr(idx + 1);\n\t\t\t\t\t}\n\t\t\t\t\tcallback(\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tnew ExternalModule(value, type || globalType, dependency.request)\n\t\t\t\t\t);\n\t\t\t\t\treturn true;\n\t\t\t\t};\n\n\t\t\t\tconst handleExternals = (externals, callback) => {\n\t\t\t\t\tif (typeof externals === \"string\") {\n\t\t\t\t\t\tif (externals === dependency.request) {\n\t\t\t\t\t\t\treturn handleExternal(dependency.request, callback);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (Array.isArray(externals)) {\n\t\t\t\t\t\tlet i = 0;\n\t\t\t\t\t\tconst next = () => {\n\t\t\t\t\t\t\tlet asyncFlag;\n\t\t\t\t\t\t\tconst handleExternalsAndCallback = (err, module) => {\n\t\t\t\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\t\t\t\tif (!module) {\n\t\t\t\t\t\t\t\t\tif (asyncFlag) {\n\t\t\t\t\t\t\t\t\t\tasyncFlag = false;\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn next();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcallback(null, module);\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\t\tasyncFlag = true;\n\t\t\t\t\t\t\t\tif (i >= externals.length) return callback();\n\t\t\t\t\t\t\t\thandleExternals(externals[i++], handleExternalsAndCallback);\n\t\t\t\t\t\t\t} while (!asyncFlag);\n\t\t\t\t\t\t\tasyncFlag = false;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tnext();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (externals instanceof RegExp) {\n\t\t\t\t\t\tif (externals.test(dependency.request)) {\n\t\t\t\t\t\t\treturn handleExternal(dependency.request, callback);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (typeof externals === \"function\") {\n\t\t\t\t\t\texternals.call(\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\tdependency.request,\n\t\t\t\t\t\t\t(err, value, type) => {\n\t\t\t\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\t\t\t\tif (value !== undefined) {\n\t\t\t\t\t\t\t\t\thandleExternal(value, type, callback);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\ttypeof externals === \"object\" &&\n\t\t\t\t\t\tObject.prototype.hasOwnProperty.call(externals, dependency.request)\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn handleExternal(externals[dependency.request], callback);\n\t\t\t\t\t}\n\t\t\t\t\tcallback();\n\t\t\t\t};\n\n\t\t\t\thandleExternals(this.externals, (err, module) => {\n\t\t\t\t\tif (err) return callback(err);\n\t\t\t\t\tif (!module) return handleExternal(false, callback);\n\t\t\t\t\treturn callback(null, module);\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n}\nmodule.exports = ExternalModuleFactoryPlugin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}