{"ast":null,"code":"'use strict';\n\nlet $module;\n\n/*\n  let contextProto = this.context;\n  while (contextProto = Object.getPrototypeOf(contextProto)) {\n    completionGroups.push(Object.getOwnPropertyNames(contextProto));\n  }\n*/\n\nfunction handle(data) {\n  let idx = data.idx,\n    child = data.child,\n    method = data.method,\n    args = data.args,\n    callback = function () {\n      let _args = Array.prototype.slice.call(arguments);\n      if (_args[0] instanceof Error) {\n        let e = _args[0];\n        _args[0] = {\n          '$error': '$error',\n          'type': e.constructor.name,\n          'message': e.message,\n          'stack': e.stack\n        };\n        Object.keys(e).forEach(function (key) {\n          _args[0][key] = e[key];\n        });\n      }\n      process.send({\n        owner: 'farm',\n        idx: idx,\n        child: child,\n        args: _args\n      });\n    },\n    exec;\n  if (method == null && typeof $module == 'function') exec = $module;else if (typeof $module[method] == 'function') exec = $module[method];\n  if (!exec) return console.error('NO SUCH METHOD:', method);\n  exec.apply(null, args.concat([callback]));\n}\nprocess.on('message', function (data) {\n  if (data.owner !== 'farm') {\n    return;\n  }\n  if (!$module) return $module = require(data.module);\n  if (data.event == 'die') return process.exit(0);\n  handle(data);\n});","map":{"version":3,"names":["$module","handle","data","idx","child","method","args","callback","_args","Array","prototype","slice","call","arguments","Error","e","constructor","name","message","stack","Object","keys","forEach","key","process","send","owner","exec","console","error","apply","concat","on","require","module","event","exit"],"sources":["/home/soon/bulletin-board/node_modules/worker-farm/lib/child/index.js"],"sourcesContent":["'use strict'\n\nlet $module\n\n/*\n  let contextProto = this.context;\n  while (contextProto = Object.getPrototypeOf(contextProto)) {\n    completionGroups.push(Object.getOwnPropertyNames(contextProto));\n  }\n*/\n\n\nfunction handle (data) {\n  let idx      = data.idx\n    , child    = data.child\n    , method   = data.method\n    , args     = data.args\n    , callback = function () {\n        let _args = Array.prototype.slice.call(arguments)\n        if (_args[0] instanceof Error) {\n          let e = _args[0]\n          _args[0] = {\n              '$error'  : '$error'\n            , 'type'    : e.constructor.name\n            , 'message' : e.message\n            , 'stack'   : e.stack\n          }\n          Object.keys(e).forEach(function(key) {\n            _args[0][key] = e[key]\n          })\n        }\n        process.send({ owner: 'farm', idx: idx, child: child, args: _args })\n      }\n    , exec\n\n  if (method == null && typeof $module == 'function')\n    exec = $module\n  else if (typeof $module[method] == 'function')\n    exec = $module[method]\n\n  if (!exec)\n    return console.error('NO SUCH METHOD:', method)\n\n  exec.apply(null, args.concat([ callback ]))\n}\n\n\nprocess.on('message', function (data) {\n  if (data.owner !== 'farm') {\n    return;\n  }\n\n  if (!$module) return $module = require(data.module)\n  if (data.event == 'die') return process.exit(0)\n  handle(data)\n})\n"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,OAAO;;AAEX;AACA;AACA;AACA;AACA;AACA;;AAGA,SAASC,MAAMA,CAAEC,IAAI,EAAE;EACrB,IAAIC,GAAG,GAAQD,IAAI,CAACC,GAAG;IACnBC,KAAK,GAAMF,IAAI,CAACE,KAAK;IACrBC,MAAM,GAAKH,IAAI,CAACG,MAAM;IACtBC,IAAI,GAAOJ,IAAI,CAACI,IAAI;IACpBC,QAAQ,GAAG,SAAAA,CAAA,EAAY;MACrB,IAAIC,KAAK,GAAGC,KAAK,CAACC,SAAS,CAACC,KAAK,CAACC,IAAI,CAACC,SAAS,CAAC;MACjD,IAAIL,KAAK,CAAC,CAAC,CAAC,YAAYM,KAAK,EAAE;QAC7B,IAAIC,CAAC,GAAGP,KAAK,CAAC,CAAC,CAAC;QAChBA,KAAK,CAAC,CAAC,CAAC,GAAG;UACP,QAAQ,EAAI,QAAQ;UACpB,MAAM,EAAMO,CAAC,CAACC,WAAW,CAACC,IAAI;UAC9B,SAAS,EAAGF,CAAC,CAACG,OAAO;UACrB,OAAO,EAAKH,CAAC,CAACI;QAClB,CAAC;QACDC,MAAM,CAACC,IAAI,CAACN,CAAC,CAAC,CAACO,OAAO,CAAC,UAASC,GAAG,EAAE;UACnCf,KAAK,CAAC,CAAC,CAAC,CAACe,GAAG,CAAC,GAAGR,CAAC,CAACQ,GAAG,CAAC;QACxB,CAAC,CAAC;MACJ;MACAC,OAAO,CAACC,IAAI,CAAC;QAAEC,KAAK,EAAE,MAAM;QAAEvB,GAAG,EAAEA,GAAG;QAAEC,KAAK,EAAEA,KAAK;QAAEE,IAAI,EAAEE;MAAM,CAAC,CAAC;IACtE,CAAC;IACDmB,IAAI;EAER,IAAItB,MAAM,IAAI,IAAI,IAAI,OAAOL,OAAO,IAAI,UAAU,EAChD2B,IAAI,GAAG3B,OAAO,MACX,IAAI,OAAOA,OAAO,CAACK,MAAM,CAAC,IAAI,UAAU,EAC3CsB,IAAI,GAAG3B,OAAO,CAACK,MAAM,CAAC;EAExB,IAAI,CAACsB,IAAI,EACP,OAAOC,OAAO,CAACC,KAAK,CAAC,iBAAiB,EAAExB,MAAM,CAAC;EAEjDsB,IAAI,CAACG,KAAK,CAAC,IAAI,EAAExB,IAAI,CAACyB,MAAM,CAAC,CAAExB,QAAQ,CAAE,CAAC,CAAC;AAC7C;AAGAiB,OAAO,CAACQ,EAAE,CAAC,SAAS,EAAE,UAAU9B,IAAI,EAAE;EACpC,IAAIA,IAAI,CAACwB,KAAK,KAAK,MAAM,EAAE;IACzB;EACF;EAEA,IAAI,CAAC1B,OAAO,EAAE,OAAOA,OAAO,GAAGiC,OAAO,CAAC/B,IAAI,CAACgC,MAAM,CAAC;EACnD,IAAIhC,IAAI,CAACiC,KAAK,IAAI,KAAK,EAAE,OAAOX,OAAO,CAACY,IAAI,CAAC,CAAC,CAAC;EAC/CnC,MAAM,CAACC,IAAI,CAAC;AACd,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script"}